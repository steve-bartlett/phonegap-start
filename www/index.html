<!DOCTYPE html>
<html>
  <head>
     <link href="css/jquery.mobile.structure-1.3.0.min.css" rel="stylesheet"/>
     <link href="css/avon_mobile.css" rel="stylesheet"/>

    <title>Cordova Offline Example</title>
    <meta name="viewport" content="width=device-width" />
    <script type="text/javascript" src="phonegap.js"></script>

	<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
	<script type="text/javascript" src="js/jquery.mobile-1.3.0.min.js"></script>

    <script type="text/javascript" charset="utf-8">
	var startURL = "https://ola.avon.com.au/Login";

    function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
    }

    function alertDismissed() {
        // do something
    }

    // Cordova is loaded and it is now safe to make calls Cordova methods
    //
    function onDeviceReady() {
	   document.addEventListener("online", onOnline, false);

        var networkState = navigator.connection.type;

		if(networkState == Connection.NONE)
		{
		   $('#start startBody').show();
		   navigator.notification.alert('You are currently Offline!',  alertDismissed, 'No connectivity', 'Done'  );
		}
		else
		{
        	window.location="https://ola.avon.com.au/Login";
        }
    }

	function onOnline() {
    	// Handle the online event
    	$.mobile.loading('show');
	    window.location = startURL;
	}

	function isConnected() {
		if (navigator.connection == null) {
			return;
		}
		var networkState = navigator.connection.type;

		if (networkState == Connection.NONE) {
			navigator.notification.alert('No connectivity!', alertDismissed, 'No connectivity', 'Done');
		}
		else {
		    $.mobile.loading('show');
			window.location = startURL;
		}
	}
    </script>
  </head>
  <body onload="onLoad()">
  		<div data-role="page" data-theme="a" id="start"  >
  		    <div data-role="header" data-position="fixed">
		                <h1>Online Appointments</h1>
		                <div style="background-color:#ED1E79; height:5px" ></div>
            </div>
            <div id="startBody" style="display:none" >
              <h2>You are currently Offline</h2>
  			  <button onclick="isConnected()" id="retry">Check Status</button>
  			</div>
  		</div>
  </body>
</html>
